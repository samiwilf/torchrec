[01;32mubuntu@ip-172-31-41-186[00m:[01;34m~/repos/torchrec-fork/examples/dlrm[00m$ torchx run -s local_cwd  aws_component.py:run_dlrm_main --num_trainers=8
[38:2:238:76:44mtorchx[0m [2m2022-03-11 18:40:07 INFO    [0m Log files located in: /tmp/torchx_wv_537z9/torchx/train_dlrm-vwqlb400b7wmzc/trainer/0
local_cwd://torchx/train_dlrm-vwqlb400b7wmzc
[38:2:238:76:44mtorchx[0m [2m2022-03-11 18:40:08 INFO    [0m Waiting for the app to finish...
[32mtrainer/0[0m WARNING:__main__:
[32mtrainer/0[0m *****************************************
[32mtrainer/0[0m Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[32mtrainer/0[0m *****************************************
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m *********  RUNNING SETTING 5  **********
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m ********************************************************************************
[32mtrainer/0[0m 
[32mtrainer/0[0m *************************************************  RUNNING SETTING 5  *******************  RUNNING SETTING 5  **********
[32mtrainer/0[0m 
[32mtrainer/0[0m 
[32mtrainer/0[0m *********  RUNNING SETTING 5  ******************************************************************************************
[32mtrainer/0[0m 
[32mtrainer/0[0m 
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m *********  RUNNING SETTING 5  **********
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m *********  RUNNING SETTING 5  **********
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m *********  RUNNING SETTING 5  **********
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m *********  RUNNING SETTING 5  **********
[32mtrainer/0[0m ****************************************
[32mtrainer/0[0m [W socket.cpp:701] The server socket on [ip-172-31-41-186.ec2.internal]:60607 is not yet listening (errno: 111 - Connection refused), will retry.
[32mtrainer/0[0m [W socket.cpp:701] The server socket on [ip-172-31-41-186.ec2.internal]:60607 is not yet listening (errno: 111 - Connection refused), will retry.
[32mtrainer/0[0m [W socket.cpp:701] The server socket on [ip-172-31-41-186.ec2.internal]:60607 is not yet listening (errno: 111 - Connection refused), will retry.
[32mtrainer/0[0m [W socket.cpp:701] The server socket on [ip-172-31-41-186.ec2.internal]:60607 is not yet listening (errno: 111 - Connection refused), will retry.
[32mtrainer/0[0m [W socket.cpp:701] The server socket on [ip-172-31-41-186.ec2.internal]:60607 is not yet listening (errno: 111 - Connection refused), will retry.
[32mtrainer/0[0m [W socket.cpp:701] The server socket on [ip-172-31-41-186.ec2.internal]:60607 is not yet listening (errno: 111 - Connection refused), will retry.
[32mtrainer/0[0m [W socket.cpp:701] The server socket on [ip-172-31-41-186.ec2.internal]:60607 is not yet listening (errno: 111 - Connection refused), will retry.
[32mtrainer/0[0m fname fname fname  fname fname   /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_11_reordered_int.npy  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_14_reordered_int.npy/home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_22_reordered_int.npy
[32mtrainer/0[0m /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_0_reordered_int.npy/home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_7_reordered_int.npy
[32mtrainer/0[0m 
[32mtrainer/0[0m 
[32mtrainer/0[0m 
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_4_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_1_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_17_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_12_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_2_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_10_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_20_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_21_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_22_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_15_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_1_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_18_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_19_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_1_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_20_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_21_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_5_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_8_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_13_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_14_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_11_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_3_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_4_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_16_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_17_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_17_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_6_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_22_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_2_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_0_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_9_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_18_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_22_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_7_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_1_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_11_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_20_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_21_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_14_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_22_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_12_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_10_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_15_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_7_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_4_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_8_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_19_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_5_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_1_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_11_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_3_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_13_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_16_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_9_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_17_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_0_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_6_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_10_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_11_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_17_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_18_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_19_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_4_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_1_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_y.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_int.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_cat.npy
[32mtrainer/0[0m fname  /home/ubuntu/mountpoint/criteo_terabyte_subsample0.0_maxind40M/day_23_reordered_int.npy
[32mtrainer/0[0m Traceback (most recent call last):
[32mtrainer/0[0m   File "/home/ubuntu/repos/torchrec-fork/examples/dlrm/dlrm_main.py", line 436, in <module>
[32mtrainer/0[0m     main(sys.argv[1:])
[32mtrainer/0[0m   File "/home/ubuntu/repos/torchrec-fork/examples/dlrm/dlrm_main.py", line 412, in main
[32mtrainer/0[0m     model = DistributedModelParallel(
[32mtrainer/0[0m   File "/home/ubuntu/repos/torchrec-fork/torchrec/distributed/model_parallel.py", line 209, in __init__
[32mtrainer/0[0m     plan = planner.collective_plan(module, sharders, pg)
[32mtrainer/0[0m   File "/home/ubuntu/repos/torchrec-fork/torchrec/distributed/planner/planners.py", line 185, in collective_plan
[32mtrainer/0[0m     return invoke_on_rank_and_broadcast_result(
[32mtrainer/0[0m   File "/home/ubuntu/repos/torchrec-fork/torchrec/distributed/collective_utils.py", line 59, in invoke_on_rank_and_broadcast_result
[32mtrainer/0[0m     dist.broadcast_object_list(object_list, rank, group=pg)
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1869, in broadcast_object_list
[32mtrainer/0[0m     broadcast(object_sizes_tensor, src=src, group=group)
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1187, in broadcast
[32mtrainer/0[0m     work = default_pg.broadcast([tensor], opts)
[32mtrainer/0[0m RuntimeError: [4] is setting up NCCL communicator and retreiving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Socket Timeout
[32mtrainer/0[0m Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:595 (most recent call first):
[32mtrainer/0[0m frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7fa6dc4dd4c2 in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libc10.so)
[32mtrainer/0[0m frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7fa6dc4d9ebf in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libc10.so)
[32mtrainer/0[0m frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x11f (0x7fa718adf67f in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
[32mtrainer/0[0m frame #3: c10d::TCPStore::doGet(std::string const&) + 0x21 (0x7fa718ae0601 in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
[32mtrainer/0[0m frame #4: c10d::TCPStore::get(std::string const&) + 0x5b (0x7fa718ae068b in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
[32mtrainer/0[0m frame #5: c10d::PrefixStore::get(std::string const&) + 0x32 (0x7fa718ab21d2 in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
[32mtrainer/0[0m frame #6: c10d::PrefixStore::get(std::string const&) + 0x32 (0x7fa718ab21d2 in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
[32mtrainer/0[0m frame #7: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, c10d::OpType, std::string const&, int) + 0xe4 (0x7fa72f54daa4 in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cpp.so)
[32mtrainer/0[0m frame #8: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x1d9 (0x7fa72f551b39 in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cpp.so)
[32mtrainer/0[0m frame #9: c10d::ProcessGroupNCCL::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) + 0x341 (0x7fa72f55cfc1 in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_cuda_cpp.so)
[32mtrainer/0[0m frame #10: <unknown function> + 0x7ff4db (0x7fa7933394db in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
[32mtrainer/0[0m frame #11: <unknown function> + 0x1f7ec2 (0x7fa792d31ec2 in /home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
[32mtrainer/0[0m frame #12: <unknown function> + 0x13c7ae (0x55a1fa3847ae in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #13: _PyObject_MakeTpCall + 0x3bf (0x55a1fa37925f in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #14: <unknown function> + 0x166d50 (0x55a1fa3aed50 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #15: _PyEval_EvalFrameDefault + 0x4f81 (0x55a1fa4229d1 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #16: _PyEval_EvalCodeWithName + 0x260 (0x55a1fa4141f0 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #17: _PyFunction_Vectorcall + 0x594 (0x55a1fa4157b4 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #18: _PyEval_EvalFrameDefault + 0x1517 (0x55a1fa41ef67 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #19: _PyEval_EvalCodeWithName + 0x260 (0x55a1fa4141f0 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #20: _PyFunction_Vectorcall + 0x594 (0x55a1fa4157b4 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #21: _PyEval_EvalFrameDefault + 0x1517 (0x55a1fa41ef67 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #22: _PyEval_EvalCodeWithName + 0x260 (0x55a1fa4141f0 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #23: _PyFunction_Vectorcall + 0x594 (0x55a1fa4157b4 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #24: _PyEval_EvalFrameDefault + 0x71a (0x55a1fa41e16a in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #25: _PyFunction_Vectorcall + 0x1b7 (0x55a1fa4153d7 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #26: _PyEval_EvalFrameDefault + 0x4bf (0x55a1fa41df0f in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #27: _PyEval_EvalCodeWithName + 0x888 (0x55a1fa414818 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #28: _PyFunction_Vectorcall + 0x594 (0x55a1fa4157b4 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #29: <unknown function> + 0x1b945a (0x55a1fa40145a in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #30: _PyObject_MakeTpCall + 0x228 (0x55a1fa3790c8 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #31: _PyEval_EvalFrameDefault + 0x540a (0x55a1fa422e5a in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #32: _PyEval_EvalCodeWithName + 0xd5f (0x55a1fa414cef in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #33: _PyFunction_Vectorcall + 0x594 (0x55a1fa4157b4 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #34: _PyEval_EvalFrameDefault + 0x71a (0x55a1fa41e16a in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #35: _PyEval_EvalCodeWithName + 0x260 (0x55a1fa4141f0 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #36: PyEval_EvalCode + 0x23 (0x55a1fa415aa3 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #37: <unknown function> + 0x241382 (0x55a1fa489382 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #38: <unknown function> + 0x252202 (0x55a1fa49a202 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #39: <unknown function> + 0x2553ab (0x55a1fa49d3ab in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #40: PyRun_SimpleFileExFlags + 0x1bf (0x55a1fa49d58f in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #41: Py_RunMain + 0x3a9 (0x55a1fa49da69 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #42: Py_BytesMain + 0x39 (0x55a1fa49dc69 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m frame #43: __libc_start_main + 0xf3 (0x7fa794cd70b3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
[32mtrainer/0[0m frame #44: <unknown function> + 0x1f7427 (0x55a1fa43f427 in /home/ubuntu/anaconda3/envs/torchrec/bin/python)
[32mtrainer/0[0m 
[32mtrainer/0[0m WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3342935 closing signal SIGTERM
[32mtrainer/0[0m WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3342936 closing signal SIGTERM
[32mtrainer/0[0m WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3342937 closing signal SIGTERM
[32mtrainer/0[0m WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3342938 closing signal SIGTERM
[32mtrainer/0[0m WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3342940 closing signal SIGTERM
[32mtrainer/0[0m WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3342941 closing signal SIGTERM
[32mtrainer/0[0m WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3342942 closing signal SIGTERM
[32mtrainer/0[0m ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 4 (pid: 3342939) of binary: /home/ubuntu/anaconda3/envs/torchrec/bin/python
[32mtrainer/0[0m Traceback (most recent call last):
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/runpy.py", line 194, in _run_module_as_main
[32mtrainer/0[0m     return _run_code(code, main_globals, None,
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/runpy.py", line 87, in _run_code
[32mtrainer/0[0m     exec(code, run_globals)
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/distributed/run.py", line 728, in <module>
[32mtrainer/0[0m     main()
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
[32mtrainer/0[0m     return f(*args, **kwargs)
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/distributed/run.py", line 724, in main
[32mtrainer/0[0m     run(args)
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/distributed/run.py", line 715, in run
[32mtrainer/0[0m     elastic_launch(
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
[32mtrainer/0[0m     return launch_agent(self._config, self._entrypoint, list(args))
[32mtrainer/0[0m   File "/home/ubuntu/anaconda3/envs/torchrec/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
[32mtrainer/0[0m     raise ChildFailedError(
[32mtrainer/0[0m torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
[32mtrainer/0[0m ============================================================
[32mtrainer/0[0m /home/ubuntu/repos/torchrec-fork/examples/dlrm/dlrm_main.py FAILED
[32mtrainer/0[0m ------------------------------------------------------------
[32mtrainer/0[0m Failures:
[32mtrainer/0[0m   <NO_OTHER_FAILURES>
[32mtrainer/0[0m ------------------------------------------------------------
[32mtrainer/0[0m Root Cause (first observed failure):
[32mtrainer/0[0m [0]:
[32mtrainer/0[0m   time      : 2022-03-11_19:33:02
[32mtrainer/0[0m   host      : ip-172-31-41-186.ec2.internal
[32mtrainer/0[0m   rank      : 4 (local_rank: 4)
[32mtrainer/0[0m   exitcode  : 1 (pid: 3342939)
[32mtrainer/0[0m   error_file: <N/A>
[32mtrainer/0[0m   traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[32mtrainer/0[0m ============================================================
[38:2:238:76:44mtorchx[0m [2m2022-03-11 19:33:05 INFO    [0m Job finished: FAILED
[38:2:238:76:44mtorchx[0m [2m2022-03-11 19:33:05 ERROR   [0m AppStatus:
  msg: <NONE>
  num_restarts: 0
  roles: []
  state: FAILED (5)
  structured_error_msg: <NONE>
  ui_url: file:///tmp/torchx_wv_537z9/torchx/train_dlrm-vwqlb400b7wmzc

[01;32mubuntu@ip-172-31-41-186[00m:[01;34m~/repos/torchrec-fork/examples/dlrm[00m$ 